# learn-claude-code 项目开发宪法 (适用于 Go 项目)

**Version: 1.3, Ratified: 2026-01-22**

本文件定义了本项目不可动摇的核心开发原则。所有代码修改必须严格遵守这些原则。

---

## 第一条：简单性原则 (Simplicity First)

**核心：** 遵循 Go 语言的"少即是多"哲学。绝不进行不必要的抽象，绝不引入非必需的依赖。

- **1.1 (YAGNI):** 只实现明确要求的功能，不推测未来需求。需要扩展时再重构。
- **1.2 (框架约束):** 在 frpc 框架约束下，非框架相关代码优先使用 Go 标准库。已选型技术栈（GORM、goconvey）除外。
- **1.3 (反过度工程):** 简单的函数和数据结构优于复杂的抽象。避免过度设计。

---

## 第二条：测试质量原则 (Test Quality) - 不可协商

**核心：** 所有新功能或 Bug 修复，必须有测试覆盖。

- **2.1 (测试先行):** 推荐遵循 TDD，但对于复杂逻辑修复可先理解现有代码再编写测试。
- **2.2 (表格驱动):** 单元测试优先采用 Table-Driven Tests，覆盖多种输入和边界情况。
- **2.3 (Mock 策略):** 优先编写集成测试；外部依赖（UniApiGateway、FOSS）通过函数变量或接口注入进行 Mock。

---

## 第三条：明确性原则 (Clarity and Explicitness) - 不可协商

**核心：** 代码的首要目的是让人类易于理解，其次才是让机器执行。

- **3.1 (错误处理):** **不可协商**：所有错误必须显式处理，绝不允许使用 `_` 丢弃错误。错误传递必须使用 `fmt.Errorf("...: %w", err)` 进行包装。
- **3.2 (依赖注入):** 不允许使用全局变量传递状态。所有依赖通过函数参数或结构体成员显式注入。
- **3.3 (GoDoc):** 公共 API 必须有清晰的注释。注释解释"为什么"，而不是"是什么"。

---

## 第四条：单一职责原则 (Single Responsibility)

**核心：** 每个包、每个文件、每个函数只做好一件事。

- **4.1 (包的内聚):** `biz` 层各包保持高内聚低耦合：
  - `record` 只处理记录逻辑
  - `convert` 只处理数据转换
  - `export` 只处理文件导出
  - 跨包调用需有明确理由
- **4.2 (接口隔离):** 定义小的、目标明确的接口，避免大而全的"上帝接口"。

---

## 第五条：修改与结构原则 (Modification and Structure)

**核心：** 保持变更的最小化，并严格控制代码规模以保障可维护性。

- **5.1 (最小化修改):** 修改代码时，遵循最小修改原则。仅修改必要的部分，避免无关的变动，降低回归风险。
- **5.2 (文件规模):** 单个文件行数应尽量控制在 200 行以内。
- **5.3 (函数规模):** 单个函数或方法行数应尽量控制在 20 行以内。
- **5.4 (行宽限制):** 单行代码尽量不超过 80 字符，强制上限为 120 字符。

---

## 第六条：文案排版原则 (Copywriting & Typography)

**核心：** 统一中文文案排版，提升文档专业度与可读性。

- **6.1 (空格规范):** 中英文之间、中文与数字之间必须增加空格。数字与单位之间增加空格（度/百分比除外）。
- **6.2 (标点使用):** 中文语境使用全角标点，英文整句使用半角标点。全角标点与其他字符间不加空格。不重复使用标点（如 `!!`）。
- **6.3 (数字与专有名词):** 数字使用半角字符。专有名词（如 GitHub, App Store）必须使用官方定义的正确大小写。

---

## 治理 (Governance)

本宪法具有最高优先级，其效力高于任何项目文档或单次指令。所有代码修改在实施前，都必须进行"合宪性审查"。

---

## 变更日志 (Changelog)

| Version | Date       | 变更说明                                                     |
| ------- | ---------- | ------------------------------------------------------------ |
| 1.3     | 2026-01-22 | 新增第六条：文案排版原则 (空格、标点、专有名词规范)          |
| 1.2     | 2026-01-22 | 新增第五条：修改与结构原则 (最小化修改、文件/函数/行宽限制)  |
| 1.1     | 2026-01-22 | 针对富途企业级项目调整：frpc 框架约束、Mock 策略、灵活性增强 |
| 1.0     | 2026-01-20 | 初始版本                                                     |
